{% extends '/dashboard/base.html.twig' %}

{% block title %}Créer un nouveau EvenementSponsor{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/css/bootstrap-datepicker.min.css">
    <style>
        .suggestion-badge {
            background-color: #28a745;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-left: 10px;
        }
    </style>
{% endblock %}

{% block content %}
    <div class="container" style="margin-top: 100px;">
        <h1>Créer une nouvelle sponsorship</h1>

        {% if sponsorSecteur is not null %}
            <div class="alert alert-info">
                <strong>Suggestion :</strong> Seuls les événements de type <strong>{{ sponsorSecteur }}</strong> sont affichés car ils correspondent au secteur du sponsor.
            </div>
        {% endif %}

        {{ form_start(form) }}
            <div class="mb-3">
                {{ form_label(form.evenement) }}
                {{ form_widget(form.evenement, {'attr': {'class': 'form-control'}}) }}
                <small class="text-muted">Événements suggérés en fonction du secteur du sponsor</small>
            </div>
            
            {% if sponsorId is not defined %}
                <div class="mb-3">
                    {{ form_label(form.sponsor) }}
                    {{ form_widget(form.sponsor, {'attr': {'class': 'form-control'}}) }}
                </div>
            {% endif %}
            
            <div class="mb-3">
                {{ form_label(form.datedebutContrat) }}
                {{ form_widget(form.datedebutContrat) }} {# Supprimez les attributs car ils sont déjà définis dans le form type #}
            </div>
            
            <div class="mb-3">
                {{ form_label(form.duree) }}
                {{ form_widget(form.duree, {'attr': {'class': 'form-control'}}) }}
            </div>
            
            <button class="btn btn-primary">{{ button_label|default('Enregistrer') }}</button>
        {{ form_end(form) }}

        <a href="{{ path('app_evenement_sponsor_index') }}" class="btn btn-secondary mt-3">Retour à la liste</a>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/locales/bootstrap-datepicker.fr.min.js"></script>
    <script>
        $(document).ready(function(){
            $('.js-datepicker').datepicker({
                format: 'yyyy-mm-dd',
                language: 'fr',
                autoclose: true,
                todayHighlight: true
            });

            // Optionnel: Mettre en avant les événements correspondants
            const secteurSponsor = $('select[name*="[evenement]"]').data('secteur');
            if (secteurSponsor) {
                $('select[name*="[evenement]"] option').each(function() {
                    if ($(this).text().includes(secteurSponsor)) {
                        $(this).attr('data-suggestion', 'true');
                    }
                });
            }
        });
    </script>
{% endblock %}