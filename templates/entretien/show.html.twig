{% extends '/dashboard/base.html.twig' %}

{% block content %}
    <div class="container mt-4">
        <div class="card">
            <h2 class="card-header text-center">Détails de l'entretien</h2>
            <div class="card-body">
                <!-- Bloc Candidat -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h4 class="text-primary">
                            <i class="fas fa-user-tie"></i>
                            Informations Candidat
                        </h4>
                        {% if candidat %}
                            <table class="table table-bordered bg-white">
                                <tbody>
                                    <tr>
                                        <th>Nom</th>
                                        <td>{{ candidat.nom }}</td>
                                    </tr>
                                    <tr>
                                        <th>Prénom</th>
                                        <td>{{ candidat.prenom }}</td>
                                    </tr>
                                    <tr>
                                        <th>Email</th>
                                        <td>{{ candidat.email }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        {% else %}
                            <p class="text-danger">Aucun candidat trouvé pour cet entretien.</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Bloc Employés concernés -->
                <div class="row mb-4">
                    <div class="col-md-12">
                        <h4 class="text-success">
                            <i class="fas fa-users"></i>
                            Employés Intervenants
                        </h4>
                        <table class="table table-striped table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>Nom</th>
                                    <th>Poste</th>
                                    <th>Email</th>
                                    <th>Département</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>{{ entretien.user.nom }} {{ entretien.user.prenom }}</td>
                                    <td>{{ entretien.user.poste }}</td>
                                    <td>{{ entretien.user.email }}</td>
                                    <td>{{ entretien.user.departement }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Bloc Offres liées à l'entretien -->
                <div class="row">
                    <div class="col-md-12">
                        <h4 class="text-info">
                            <i class="fas fa-briefcase"></i>
                            Offres associées
                        </h4>
                        <table class="table table-bordered table-striped">
                            <thead class="table-light">
                                <tr>
                                    <th>Titre de l'offre</th>
                                    <th>Date de publication</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>{{ entretien.offre.titre }}</td>
                                    <td>{{ entretien.offre.datePublication|date('d/m/Y') }}</td>
                                    <td class="offre-description">{{ entretien.offre.description }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Boutons de navigation -->
                <div class="mt-4 text-center">
                    <a href="{{ path('app_entretien_index') }}" class="btn btn-secondary">Retour à la liste</a>
                    <a href="{{ path('app_entretien_edit', {'id': entretien.id}) }}" class="btn btn-warning">Modifier</a>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Ensure long descriptions wrap in the table */
        .offre-description {
            white-space: normal !important; /* Allow text to wrap */
            word-wrap: break-word; /* Break long words if needed */
            max-width: 400px; /* Limit column width for readability */
            vertical-align: top; /* Align text to the top */
            padding: 10px; /* Add padding for better spacing */
        }

        /* Optional: Limit table width */
        .table {
            table-layout: auto; /* Allow columns to adjust naturally */
        }
    </style>
{% endblock %}