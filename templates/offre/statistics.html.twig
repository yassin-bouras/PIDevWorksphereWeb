{% extends '/dashboard/base2.html.twig' %}

{% block title %}Statistiques des Offres{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ importmap('app') }}
    <style>
        /* Enterprise Design System Variables */
        :root {
            --primary-color: #33ccc5;
            --primary-dark: #2a9d8f;
            --primary-light: #a8e4e0;
            --primary-gradient: linear-gradient(135deg, #33ccc5, #1a7b75);
            --bg-white: #ffffff;
            --bg-light: #f8fafc;
            --bg-light-hover: #f1f5f9;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.06), 0 2px 4px -1px rgba(0, 0, 0, 0.04);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -2px rgba(0, 0, 0, 0.04);
            --shadow-focus: 0 0 0 3px rgba(51, 204, 197, 0.4);
            --radius-md: 0.5rem;
            --font-weight-semibold: 600;
            --space-2: 0.5rem;
            --space-3: 0.75rem;
            --space-4: 1rem;
            --space-5: 1.25rem;
            --animation-base: 0.3s ease;
            --animation-timing: cubic-bezier(0.16, 1, 0.3, 1);
            --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .card {
            margin-bottom: 20px;
        }

        /* Back button matching design from other pages */
        .back-button {
            position: relative;
            background-color: var(--bg-white);
            color: var(--primary-color);
            border: none;
            border-radius: var(--radius-md);
            padding: var(--space-3) var(--space-5);
            font-weight: var(--font-weight-semibold);
            transition: all var(--animation-base) var(--animation-timing);
            display: inline-flex;
            align-items: center;
            margin-bottom: var(--space-4);
            box-shadow: var(--shadow-md);
            text-decoration: none;
            overflow: hidden;
        }

        .back-button:hover {
            background-color: var(--bg-light-hover);
            transform: translateX(-5px);
            box-shadow: var(--shadow-lg);
            color: var(--primary-dark);
            text-decoration: none;
        }

        .back-button:focus {
            outline: none;
            box-shadow: var(--shadow-focus);
        }

        .back-button::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform var(--animation-base) var(--animation-bounce);
        }

        .back-button:hover::after {
            transform: scaleX(1);
        }

        .back-button i {
            margin-right: var(--space-2);
            transition: transform var(--animation-base) var(--animation-timing);
        }

        .back-button:hover i {
            transform: translateX(-3px);
        }

        /* Add ripple effect for the back button */
        @keyframes ripple {
            0% {
                width: 5px;
                height: 5px;
                opacity: 1;
            }
            100% {
                width: 300px;
                height: 300px;
                opacity: 0;
            }
        }
    </style>
{% endblock %}

{% block js %}
    <script src="{{ asset('back/js/jquery-3.6.0.min.js') }}"></script>
    <script src="{{ asset('back/js/popper.min.js') }}"></script>
    <script src="{{ asset('back/js/bootstrap.min.js') }}"></script>
    <script src="{{ asset('back/js/feather.min.js') }}"></script>
    <script src="{{ asset('back/plugins/slimscroll/jquery.slimscroll.min.js') }}"></script>
    <script src="{{ asset('back/js/script.js') }}"></script>
{% endblock %}

{% block content %}
<div class="content container-fluid" style="margin-top: -58%">
    <div class="page-header">
        <div class="row">
            <div class="col-sm-12">
                <h3 class="page-title">Statistiques des Offres</h3>
                <ul class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ path('app_dashboard') }}">Dashboard</a></li>
                    <li class="breadcrumb-item"><a href="{{ path('app_offre_index') }}">Offres</a></li>
                    <li class="breadcrumb-item active">Statistiques</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 mb-4">
            <div class="text-start">
                <a href="{{ path('app_offre_index') }}" class="back-button" data-tooltip="Retourner à la liste des offres">
                    <i class="fas fa-arrow-left"></i> Retour à la liste des offres
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Contract Type Chart -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Offres par Type de Contrat</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        {{ render_chart(contractTypeChart) }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Experience Chart -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Offres par Niveau d'Expérience</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        {{ render_chart(experienceChart) }}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Location Chart -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Offres par Localisation</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        {{ render_chart(locationChart) }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Date Chart -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Offres Publiées par Mois</h5>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        {{ render_chart(dateChart) }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add ripple effect to back button
        const backButton = document.querySelector('.back-button');
        
        if (backButton) {
            backButton.addEventListener('click', function(e) {
                const x = e.clientX - this.getBoundingClientRect().left;
                const y = e.clientY - this.getBoundingClientRect().top;
                
                const ripple = document.createElement('span');
                ripple.style.cssText = `
                    position: absolute;
                    background: rgba(255, 255, 255, 0.7);
                    border-radius: 50%;
                    width: 5px;
                    height: 5px;
                    top: ${y}px;
                    left: ${x}px;
                    transform: translate(-50%, -50%);
                    animation: ripple 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
                    pointer-events: none;
                `;
                
                this.style.position = 'relative';
                this.style.overflow = 'hidden';
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        }
    });
</script>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
{% endblock %}